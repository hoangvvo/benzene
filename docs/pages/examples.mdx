import { useState, useMemo } from "react";
import { useSSG } from "nextra/ssg";
import Callout from 'nextra-theme-docs/callout';
import Fuse from "fuse.js";

export const repo = "hoangvvo/benzene";

export const getStaticProps = async () => {
  const exampleUrls = await fetch(
    "https://api.github.com/repos/hoangvvo/benzene/git/trees/main"
  )
    .then((res) => res.json())
    .then(
      (json) =>
        Object.values(json.tree).find((obj) => obj.path === "examples").url
    );
  const examplePaths = await fetch(exampleUrls)
    .then((res) => res.json())
    .then((json) => json.tree.map((t) => t.path));
  const examples = [];
  for (const examplePath of examplePaths) {
    const packageJson = await fetch(
      `https://raw.githubusercontent.com/${repo}/main/examples/${examplePath}/package.json`
    )
      .then((res) => res.json())
      .then((json) => ({
        name: json.name,
        description: json.description || null,
        slug: examplePath,
      }));
    examples.push(packageJson);
  }
  return { props: { ssg: examples } };
};

export const ExamplesRenderer = () => {
  const examples = useSSG();
  const [search, setSearch] = useState();
  const [fuse] = useState(
    () =>
      new Fuse(examples, {
        keys: ["name", "description"],
      })
  );
  const searchedExamples = useMemo(() => {
    if (!search) return examples;
    return fuse.search(search).map((result) => result.item);
  }, [search, examples]);
  return (
    <>
      <input
        value={search}
        onChange={(event) => setSearch(event.currentTarget.value)}
        style={{ margin: "1rem 0 0", color: "#000" }}
        type="search"
        className="appearance-none border rounded py-2 px-3 leading-tight focus:outline-none focus:ring w-full"
        placeholder="Search examples"
      />
      <div style={{ height: "32rem", overflow: "auto" }}>
        {searchedExamples.map((example) => (
          <Callout key={example.slug} emoji="">
            <h3 style={{ marginTop: 0 }}>{example.name}</h3>
            <p style={{ marginTop: 0 }}>{example.description}</p>
            <div>
              <a
                href={`http://github.com/${repo}/tree/main/examples/${example.slug}`}
              >
                Source
              </a>{" "}
              <a
                href={`https://githubbox.com/${repo}/tree/main/examples/${example.slug}`}
              >
                CodeSandbox
              </a>
            </div>
          </Callout>
        ))}
      </div>
    </>
  );
};

# Examples

There are several examples that show us how we can integrate **Benzene** into any frameworks and runtimes.
We would soon see how Benzene's flexibity and genericity offer support for anything out there in the JavaScript ecosystem.

## Official examples

<ExamplesRenderer />
